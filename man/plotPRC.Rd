% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plotPRC.R
\name{plotPRC}
\alias{plotPRC}
\title{1d PRC diagram}
\usage{
plotPRC(
  object,
  treatment = NULL,
  condition = NULL,
  plot = 1,
  xvals = NULL,
  axis = 1,
  size = c(2, 2),
  symbols_on_curves = FALSE,
  width = c(4, 1),
  title = NULL,
  left = "Treatment and plot scores",
  right = "taxon scores",
  threshold = 7,
  y_lab_interval = 0.5,
  speciesname = NULL,
  selectname = "Fratio",
  verbose = TRUE
)
}
\arguments{
\item{object}{a result of \code{\link{PRC_scores}} or a list with element
PRCplus (a data frame with a variables to plot, see details).}

\item{treatment}{character vector of names of factors in \code{object$PRCplus},
 the first two of which set the \code{color} and \code{linetype} of treatments.
Default: derived from \code{object$'focal_and_conditioning_factors'}.}

\item{condition}{character vector of names of factors in \code{object$PRCplus}, the first one being used as x-axis.
Default: derived from \code{object$'focal_and_conditioning_factors'}.}

\item{plot}{0 or 1 ((no/yes individual plot points)) or
character name of a factor in \code{object$PRCplus} indicating the plots
(microcosms, subjects or objects) in a longitudinal study so as to plot lines.
Default: 1 yielding points instead of lines.}

\item{xvals}{numeric values for the levels of the condition factor,
or name of numeric variable in \code{object$PRCplus} to be used for the x-axis. Default: NULL for which the values are
obtained using the function \code{\link{fvalues4levels}} applied to \code{object$PRCplus[[condition[1]]]}}

\item{axis}{axis shown; default 1, showing the first PRC axis.}

\item{size}{size of symbols and symbols in the legend. default: c(2, 2). If the length is not 2 than the first entry is replicated.}

\item{symbols_on_curves}{logical draw symbols on the PRC curves at the measurement times (default FALSE).
If \code{TRUE}, symbols are for the treatment, if there is one, and for the second treatment if there are two.}

\item{width}{relative width of treatment PRC plot and the loading plot (see \code{\link[gridExtra]{grid.arrange}}).}

\item{title}{overall title.}

\item{left}{left axis text (see \code{\link[gridExtra]{arrangeGrob}}).}

\item{right}{right axis text (see \code{\link[gridExtra]{arrangeGrob}})}

\item{threshold}{species with criterion (specified by \code{selectname}) higher than the \code{threshold} are displayed.
Default: 7
(which is the threshold F-ratio for testing a single regression coefficient
at \code{p=0.01} with \code{60} df for the error in a multiple regression
of each single species onto the condition and the ordination axis).
If \code{selectname} is not in \code{species_scores}, the \code{threshold} is divided by \code{14}, so that the default is 0.5.}

\item{y_lab_interval}{interval of the y-axis ticks. A tick at no effect (0) is always included; default: 0.5.}

\item{speciesname}{name of the variable containing the species names (default \code{NULL} uses rownames in \code{object$species})}

\item{selectname}{name of the column or variable containing the criterion for the selection of species to be displayed
without \code{".1"} or other \code{axis} number.
Default: \code{"Fratio"};if \code{selectname} is not found in \code{object$species_scores}, set to \code{scoresname}.
e.g. the \code{"RDA1"} scores.}

\item{verbose}{logical for printing the current model, \code{score_name}, \code{condition} and \code{treatment} (default TRUE).}
}
\value{
a list of a gridExtra object (plot using \code{\link[gridExtra]{arrangeGrob}})
and a list of two ggplot2 objects (the treatment PRC-diagram and the vertical line plot).
}
\description{
\code{plotPRC} creates a one-dimensional PRC diagram with
vertical line plot of species loadings from a result of \code{\link{PRC_scores}}.
}
\details{
The function creates the treatment PRC diagram using \code{\link{plot_sample_scores_cdt}} and the
vertical line plot of loadings using \code{\link{plot_species_scores_bk}}. These ggplot2-objects are
combined in a single object using \code{\link[gridExtra]{arrangeGrob}}.
}
\examples{
data(pyrifos, package = "vegan") #transformed species data from package vegan
#the chlorpyrifos experiment from van den Brink & ter Braak 1999
Design <- data.frame(week=gl(11, 12, labels=c(-4, -1, 0.1, 1, 2, 4, 8, 12, 15, 19, 24)),
                     dose=factor(rep(c(0.1, 0, 0, 0.9, 0, 44, 6, 0.1, 44, 0.9, 0, 6), 11)),
                     ditch = gl(12, 1, length=132))

mod_rda <- rda( pyrifos ~ dose:week + Condition(week),  data = Design)
print(mod_rda)
#                 Proporti Rank
# Total           1.0000
# Conditional     0.2192   10 (between-week variation)
# Constrained     0.3346   44 (between-treatment variation across weeks)
# Unconstrained   0.4462   77 (within-week variation)
#
mod_prc <- PRC_scores(mod_rda, data= Design)
# without lines, threshold is 7
# this is about P = 0.01 for PRC1 in the regression "species_k ~ week+PRC1"
sum(mod_prc$species[,"Fratio1"] >7) # 34
# this retains 34 species to be plotted with names
plotPRC(mod_prc, width = c(4,1), symbols_on_curves = TRUE)
sum(mod_prc$species[,"Fratio1"] >7) # 34
# with lines and a stronger threshold
sum(mod_prc$species[,"Fratio1"] >10) # 29
plotPRC(mod_prc, plot = "ditch", threshold = 10,width = c(4,1))

# modifying the plot
gg <- plotPRC(mod_prc, plot = "ditch",width = c(4,1), verbose = FALSE)
p1 <- gg$separateplots$treatments + ggplot2::ggtitle(paste("new title:", latex2exp::TeX("$c_{dt}$")))   # PRC plot of samples (c_dt)
p2 <- gg$separateplots$species    + ggplot2::ylab("new title: loadings")# loadings of species  (b_k)
# Assign these plots to symbols and use grid.arrange to produce the plot  you like, for example:
gridExtra::grid.arrange(p1+ ggplot2::ylab("")+ ggplot2::xlab("week since chorpyrifos application") + ggplot2::ggtitle(""),
                        p2, ncol =2, widths = c(4,1),
                        top = "new title", left ="PRC curves of treaments", right =  "PRC species loadings")

# test significance of PRC/RDA axes ---------------------------------------

## Ditches are randomized, we have a time series, and are only
## interested in the first axis
ctrl <- how(plots = Plots(strata = Design$ditch,type = "free"),
            within = Within(type = "none"), nperm = 99)

anova(mod_rda, by = "axis",permutations=  ctrl, model = "reduced", cutoff = 0.10)


}
\seealso{
\code{\link{PRC_scores}}, \code{\link{plot_sample_scores_cdt}},
\code{\link{plot_species_scores_bk}} and \code{\link[gridExtra]{grid.arrange}}
}
